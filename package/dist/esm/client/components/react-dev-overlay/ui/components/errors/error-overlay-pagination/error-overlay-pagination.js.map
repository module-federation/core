{"version":3,"sources":["../../../../../../../../src/client/components/react-dev-overlay/ui/components/errors/error-overlay-pagination/error-overlay-pagination.tsx"],"sourcesContent":["import {\n  startTransition,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\nimport { LeftArrow } from '../../../icons/left-arrow'\nimport { RightArrow } from '../../../icons/right-arrow'\nimport type { ReadyRuntimeError } from '../../../../utils/get-error-by-type'\n\ntype ErrorPaginationProps = {\n  runtimeErrors: ReadyRuntimeError[]\n  activeIdx: number\n  onActiveIndexChange: (index: number) => void\n}\n\nexport function ErrorOverlayPagination({\n  runtimeErrors,\n  activeIdx,\n  onActiveIndexChange,\n}: ErrorPaginationProps) {\n  const handlePrevious = useCallback(\n    () =>\n      startTransition(() => {\n        if (activeIdx > 0) {\n          onActiveIndexChange(Math.max(0, activeIdx - 1))\n        }\n      }),\n    [activeIdx, onActiveIndexChange]\n  )\n\n  const handleNext = useCallback(\n    () =>\n      startTransition(() => {\n        if (activeIdx < runtimeErrors.length - 1) {\n          onActiveIndexChange(\n            Math.max(0, Math.min(runtimeErrors.length - 1, activeIdx + 1))\n          )\n        }\n      }),\n    [activeIdx, runtimeErrors.length, onActiveIndexChange]\n  )\n\n  const buttonLeft = useRef<HTMLButtonElement | null>(null)\n  const buttonRight = useRef<HTMLButtonElement | null>(null)\n\n  const [nav, setNav] = useState<HTMLElement | null>(null)\n  const onNav = useCallback((el: HTMLElement) => {\n    setNav(el)\n  }, [])\n\n  useEffect(() => {\n    if (nav == null) {\n      return\n    }\n\n    const root = nav.getRootNode()\n    const d = self.document\n\n    function handler(e: KeyboardEvent) {\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault()\n        e.stopPropagation()\n        handlePrevious && handlePrevious()\n      } else if (e.key === 'ArrowRight') {\n        e.preventDefault()\n        e.stopPropagation()\n        handleNext && handleNext()\n      }\n    }\n\n    root.addEventListener('keydown', handler as EventListener)\n    if (root !== d) {\n      d.addEventListener('keydown', handler)\n    }\n    return function () {\n      root.removeEventListener('keydown', handler as EventListener)\n      if (root !== d) {\n        d.removeEventListener('keydown', handler)\n      }\n    }\n  }, [nav, handleNext, handlePrevious])\n\n  // Unlock focus for browsers like Firefox, that break all user focus if the\n  // currently focused item becomes disabled.\n  useEffect(() => {\n    if (nav == null) {\n      return\n    }\n\n    const root = nav.getRootNode()\n    // Always true, but we do this for TypeScript:\n    if (root instanceof ShadowRoot) {\n      const a = root.activeElement\n\n      if (activeIdx === 0) {\n        if (buttonLeft.current && a === buttonLeft.current) {\n          buttonLeft.current.blur()\n        }\n      } else if (activeIdx === runtimeErrors.length - 1) {\n        if (buttonRight.current && a === buttonRight.current) {\n          buttonRight.current.blur()\n        }\n      }\n    }\n  }, [nav, activeIdx, runtimeErrors.length])\n\n  return (\n    <nav\n      className=\"error-overlay-pagination dialog-exclude-closing-from-outside-click\"\n      ref={onNav}\n    >\n      <button\n        ref={buttonLeft}\n        type=\"button\"\n        disabled={activeIdx === 0}\n        aria-disabled={activeIdx === 0}\n        onClick={handlePrevious}\n        data-nextjs-dialog-error-previous\n        className=\"error-overlay-pagination-button\"\n      >\n        <LeftArrow\n          title=\"previous\"\n          className=\"error-overlay-pagination-button-icon\"\n        />\n      </button>\n      <div className=\"error-overlay-pagination-count\">\n        <span data-nextjs-dialog-error-index={activeIdx}>{activeIdx + 1}/</span>\n        <span data-nextjs-dialog-header-total-count>\n          {/* Display 1 out of 1 if there are no errors (e.g. for build errors). */}\n          {runtimeErrors.length || 1}\n        </span>\n      </div>\n      <button\n        ref={buttonRight}\n        type=\"button\"\n        // If no errors or the last error is active, disable the button.\n        disabled={activeIdx >= runtimeErrors.length - 1}\n        aria-disabled={activeIdx >= runtimeErrors.length - 1}\n        onClick={handleNext}\n        data-nextjs-dialog-error-next\n        className=\"error-overlay-pagination-button\"\n      >\n        <RightArrow\n          title=\"next\"\n          className=\"error-overlay-pagination-button-icon\"\n        />\n      </button>\n    </nav>\n  )\n}\n\nexport const styles = `\n  .error-overlay-pagination {\n    -webkit-font-smoothing: antialiased;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 8px;\n    width: fit-content;\n  }\n\n  .error-overlay-pagination-count {\n    color: var(--color-gray-900);\n    text-align: center;\n    font-size: var(--size-14);\n    font-weight: 500;\n    line-height: var(--size-16);\n    font-variant-numeric: tabular-nums;\n  }\n\n  .error-overlay-pagination-button {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    width: var(--size-24);\n    height: var(--size-24);\n    background: var(--color-gray-300);\n    flex-shrink: 0;\n\n    border: none;\n    border-radius: var(--rounded-full);\n\n    svg {\n      width: var(--size-16);\n      height: var(--size-16);\n    }\n\n    &:focus-visible {\n      outline: var(--focus-ring);\n    }\n\n    &:not(:disabled):active {\n      background: var(--color-gray-500);\n    }\n\n    &:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n  }\n\n  .error-overlay-pagination-button-icon {\n    color: var(--color-gray-1000);\n  }\n`\n"],"names":["startTransition","useCallback","useEffect","useRef","useState","LeftArrow","RightArrow","ErrorOverlayPagination","runtimeErrors","activeIdx","onActiveIndexChange","handlePrevious","Math","max","handleNext","length","min","buttonLeft","buttonRight","nav","setNav","onNav","el","root","getRootNode","d","self","document","handler","e","key","preventDefault","stopPropagation","addEventListener","removeEventListener","ShadowRoot","a","activeElement","current","blur","className","ref","button","type","disabled","aria-disabled","onClick","data-nextjs-dialog-error-previous","title","div","span","data-nextjs-dialog-error-index","data-nextjs-dialog-header-total-count","data-nextjs-dialog-error-next","styles"],"mappings":"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"}