{"version":3,"sources":["../../../../src/server/lib/incremental-cache/fetch-cache.ts"],"names":["LRUCache","z","CACHE_ONE_YEAR","NEXT_CACHE_SOFT_TAGS_HEADER","rateLimitedUntil","memoryCache","CACHE_TAGS_HEADER","CACHE_HEADERS_HEADER","CACHE_STATE_HEADER","CACHE_REVALIDATE_HEADER","CACHE_FETCH_URL_HEADER","CACHE_CONTROL_VALUE_HEADER","zCachedFetchValue","object","kind","literal","data","headers","record","string","body","url","status","number","optional","tags","array","revalidate","FetchCache","hasMatchingTags","arr1","arr2","length","set1","Set","set2","size","tag","has","isAvailable","ctx","_requestHeaders","process","env","SUSPENSE_CACHE_URL","constructor","debug","NEXT_PRIVATE_DEBUG_CACHE","newHeaders","JSON","parse","k","scHost","scBasePath","SUSPENSE_CACHE_BASEPATH","SUSPENSE_CACHE_AUTH_TOKEN","cacheEndpoint","console","log","maxMemoryCacheSize","max","value","stringify","props","Error","html","pageData","resetRequestCache","reset","revalidateTag","Date","now","res","fetch","encodeURIComponent","method","next","internal","retryAfter","get","parseInt","ok","err","warn","args","key","softTags","kindHint","fetchIdx","fetchUrl","hasFetchKindAndMatchingTags","start","fetchParams","fetchType","join","error","text","json","parsed","safeParse","success","cached","includes","push","cacheState","age","lastModified","Object","keys","set","fetchCache","toString","undefined"],"mappings":"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"}