import ErrorCodeTitle from '@components/ErrorCodeTitle';

<ErrorCodeTitle code='RUNTIME-003'/>

## Reasons

Failed to load the manifest, which can occur due to:

1. The manifest URL may be wrong or unreachable
2. Network connectivity issues
3. CORS (Cross-Origin Resource Sharing) restrictions
4. Remote service is offline or not yet deployed
5. DNS resolution failures

## Solutions

### Basic Troubleshooting
1. Check whether manifestUrl can be accessed directly in browser
2. Verify the manifest URL format and path correctness
3. Check network connectivity and DNS resolution
4. Review CORS configuration on the remote server

### Advanced Solutions

#### 1. Implement Error Handling with Runtime Plugins

Use the `errorLoadRemote` hook to handle manifest loading failures gracefully:

```ts
import type { ModuleFederationRuntimePlugin } from '@module-federation/enhanced/runtime';

const offlineHandlingPlugin: () => ModuleFederationRuntimePlugin = () => ({
  name: 'offline-handling-plugin',
  errorLoadRemote(args) {
    if (args.lifecycle === 'afterResolve') {
      console.warn(`Failed to load remote ${args.id}, providing fallback`);
      // Provide fallback manifest or backup URL
      return {
        id: 'fallback',
        name: 'fallback',
        metaData: { /* fallback configuration */ },
        shared: [],
        remotes: [],
        exposes: []
      };
    }
  },
});
```

#### 2. Use Retry Plugin

Add automatic retry mechanism for transient network failures:

```ts
import { RetryPlugin } from '@module-federation/retry-plugin';

// In your Module Federation configuration
runtimePlugins: [
  () => RetryPlugin({
    fetch: {
      retryTimes: 3,
      retryDelay: 1000,
    },
  }),
],
```

#### 3. Environment-Specific Handling

For different environments, consider:
- **Development**: Log detailed error information
- **Production**: Provide graceful fallbacks without exposing internal errors
- **Staging**: Use backup servers or cached manifests

### ShareStrategy Impact

Note that both `shareStrategy: 'loaded-first'` and `shareStrategy: 'version-first'` will trigger manifest loading during application initialization. Consider implementing proper error handling before using these strategies in production.
