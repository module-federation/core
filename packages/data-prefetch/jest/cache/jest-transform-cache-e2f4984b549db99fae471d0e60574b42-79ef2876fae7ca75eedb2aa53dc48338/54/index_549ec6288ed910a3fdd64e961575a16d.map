{"version":3,"sources":["/Users/bytedance/WebstormProjects/universe/packages/data-prefetch/src/universal/index.ts"],"sourcesContent":["import { MFDataPrefetch, type prefetchOptions } from '../prefetch';\nimport { getScope } from '../common/runtime-utils';\n\nexport function prefetch(options: prefetchOptions): Promise<any> {\n  const { id, functionId = 'default' } = options;\n  const mfScope = getScope();\n\n  const prefetchInstance =\n    MFDataPrefetch.getInstance(mfScope) ||\n    new MFDataPrefetch({\n      name: mfScope,\n    });\n\n  const res = prefetchInstance.getProjectExports();\n  if (res instanceof Promise) {\n    const promise = res.then(() => {\n      const result = prefetchInstance!.prefetch(options);\n      prefetchInstance.memorize(id + functionId, result);\n      return result;\n    });\n    return promise;\n  } else {\n    const result = prefetchInstance!.prefetch(options);\n    prefetchInstance.memorize(id + functionId, result);\n    return result;\n  }\n}\n"],"names":["prefetch","options","id","functionId","mfScope","getScope","prefetchInstance","MFDataPrefetch","getInstance","name","res","getProjectExports","Promise","promise","then","result","memorize"],"mappings":";;;;+BAGgBA;;;eAAAA;;;0BAHqC;8BAC5B;AAElB,SAASA,SAASC,OAAwB;IAC/C,MAAM,EAAEC,EAAE,EAAEC,aAAa,SAAS,EAAE,GAAGF;IACvC,MAAMG,UAAUC,IAAAA,sBAAQ;IAExB,MAAMC,mBACJC,wBAAc,CAACC,WAAW,CAACJ,YAC3B,IAAIG,wBAAc,CAAC;QACjBE,MAAML;IACR;IAEF,MAAMM,MAAMJ,iBAAiBK,iBAAiB;IAC9C,IAAID,eAAeE,SAAS;QAC1B,MAAMC,UAAUH,IAAII,IAAI,CAAC;YACvB,MAAMC,SAAST,iBAAkBN,QAAQ,CAACC;YAC1CK,iBAAiBU,QAAQ,CAACd,KAAKC,YAAYY;YAC3C,OAAOA;QACT;QACA,OAAOF;IACT,OAAO;QACL,MAAME,SAAST,iBAAkBN,QAAQ,CAACC;QAC1CK,iBAAiBU,QAAQ,CAACd,KAAKC,YAAYY;QAC3C,OAAOA;IACT;AACF"}